<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="WorkoutTracker.Views.ChartsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.Maui;assembly=LiveChartsCore.SkiaSharpView.Maui"
    Title="Progress">

    <VerticalStackLayout Padding="16" Spacing="12">

        <Picker Title="Exercise"
            ItemsSource="{Binding Exercises}"
            ItemDisplayBinding="{Binding Name}"
            SelectedItem="{Binding SelectedExercise}" />

        <RefreshView IsRefreshing="{Binding IsBusy}"
                 Command="{Binding RefreshCommand}">
            <lvc:CartesianChart
          Series="{Binding VolumeSeries}"
          XAxes="{Binding XAxes}"
          YAxes="{Binding YAxes}"
          HeightRequest="300" />
        </RefreshView>

        <Label Text="{Binding StatusText}"
           FontSize="12"
           Opacity="0.7" />

        <!-- Diagnostics: what the VM computed (day + volume) -->
        <CollectionView ItemsSource="{Binding DebugPoints}"
                    HeightRequest="120">
            <CollectionView.EmptyView>
                <Label Text="(No computed points yet)"
               FontSize="12" Opacity="0.5" />
            </CollectionView.EmptyView>
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Grid ColumnDefinitions="Auto,*" Padding="0,2">
                        <Label Text="{Binding Day, StringFormat='{}{0:MMM d}'}"
                   FontSize="12" />
                        <Label Grid.Column="1"
                   Text="{Binding Volume, StringFormat='{0:0.##} kg'}"
                   FontSize="12" />
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

    </VerticalStackLayout>
</ContentPage>
